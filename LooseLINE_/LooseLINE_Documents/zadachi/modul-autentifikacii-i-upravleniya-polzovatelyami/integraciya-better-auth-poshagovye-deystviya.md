---
order: 1
title: Интеграция Better-Auth (Пошаговые действия)
---

# Интеграция Better-Auth (Пошаговые действия)

Ниже описаны конкретные действия и команды, которые мы выполнили для настройки системы.

### 1. Установка пакетов
Сначала мы установили саму библиотеку и драйвер для базы данных PostgreSQL.
**Команда:**
```bash
npm install better-auth pg
```

### 2. Настройка переменных окружения
Мы убедились, что в файле `.env` прописана строка подключения к базе.
**Действие:**
Добавили/проверили в `.env`:
```
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
```

### 3. Создание конфигурации (Используем ли мы адаптер?)
**Важный момент:** Мы **не используем** сторонние адаптеры для ORM (например, `Prisma Adapter` или `Drizzle Adapter`), потому что мы не используем эти ORM в проекте.

Вместо этого мы используем **встроенную поддержку PostgreSQL** в `better-auth` через драйвер `pg`. Мы передаем экземпляр `Pool` прямо в конфиг. Это работает "напрямую" и является самым производительным способом.

**Действие:**
В файле `frontend/auth.ts` мы передаем объект `database` с пулом соединений `pg`:
```typescript
import { betterAuth } from "better-auth"
import { Pool } from "pg" // <--- Это наш "адаптер" (драйвер)

export const auth = betterAuth({
  database: new Pool({
    connectionString: process.env.DATABASE_URL 
  }),
  // ...остальные настройки
})
```

### 4. Генерация и применение миграций
Самый важный шаг для автоматизации базы данных. Мы использовали CLI инструмент better-auth, чтобы он посмотрел на нашу конфигурацию и создал таблицы.

**Команда:**
```bash
npx better-auth migrate
```
*Эта команда автоматически подключилась к базе, создала папку `better-auth_migrations` с SQL-файлом и применила его к базе данных, создав таблицы `user`, `session`, `account` и `verification`.*

### Итог
После этих действий у нас:
1.  Установлены библиотеки (`better-auth` + `pg`).
2.  Настроен `auth.ts` (используем прямой драйвер `pg` без лишних прослоек).
3.  База данных автоматически синхронизирована (таблицы созданы).
